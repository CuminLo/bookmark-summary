# 记录一次折腾WIFI漫游的过程 - Group B
- URL: https://www.drxcloud.club/765.html
- Added At: 2025-03-03 03:37:47
- [Link To Text](2025-03-03-记录一次折腾wifi漫游的过程---group-b_raw.md)

## TL;DR
作者将小米AC2100路由器刷入OpenWRT固件，并配置802.11k/v/r协议，成功实现了WIFI自动漫游功能。通过调整信道、信号强度和DAWN服务，优化了漫游效果，测试结果良好。未来可进一步调整配置以提升性能。

## Summary
1. **背景介绍**：
   - **设备更换**：作者原本使用X86 OpenWRT作为路由器，现替换为小米AC2100，并计划实现WIFI自动漫游。
   - **设备来源**：小米AC2100是2019年购买的路由器，曾作为AP使用，后因获得WIFI6路由器而被替换。

2. **技术准备**：
   - **技术摘要**：在开始配置前，需要了解802.11系列协议、WIFI信道、信号值dBm等基础知识。
   - **802.11协议**：
     - **802.11k**：帮助客户端选择最佳AP。
     - **802.11v**：AP主动通知客户端网络信息。
     - **802.11r**：减少客户端在不同AP间切换的延迟。
     - **802.11s**：定义MESH网络的框架和操作。
     - **802.11ac/ax**：分别称为WIFI5和WIFI6，支持160MHz带宽。
   - **WIFI信道**：中国地区可用的WIFI信道，需避开同频段信号较多的信道以增强信号质量。
   - **信号值dBm**：客户端接收到的信号强度，数值越小信号越好。

3. **设备配置**：
   - **刷入OpenWRT固件**：
     - 降级原厂固件至漏洞版本，通过URL注入开启SSH，刷入OpenWRT固件。
     - 修改管理员密码，获取stok值，开启SSH并登录。
   - **配置OpenWRT**：
     - 配置R1作为出口路由，R2、R3作为无线接入点。
     - 容错配置，桥接端口，更新wpad包以支持802.11k/v/r。
     - 安装dawn服务，配置广播地址和端口，重启服务。

4. **无线接入点配置**：
   - **配置AP**：
     - 配置radio1（5G），修改国家代码，选择信道，设置带宽和发送功率。
     - 绑定网络为SWITCH，选择加密方式为WPA2-PSK。
     - 配置WLAN漫游菜单，启用802.11r快速切换，设置重关联截止时间和FT协议。
   - **测试验证**：
     - 使用iperf3进行网速测试，ping大包测试，观察漫游效果。
     - 编辑无线配置文件开启syslog，查看FT工作情况。

5. **DAWN配置**：
   - **调整建议**：
     - 启用信道利用率检测，设置RSSI阈值，确保客户端可以及时切换到信号更强的AP。
     - 设置DAWN的日志级别和监控机制，以便及时发现和解决问题。

6. **总结**：
   - 通过配置小米AC2100和OpenWRT固件，作者成功实现了WIFI自动漫游功能，测试结果令人满意。
   - 未来可以根据实际环境进一步调整DAWN配置，优化漫游效果。
