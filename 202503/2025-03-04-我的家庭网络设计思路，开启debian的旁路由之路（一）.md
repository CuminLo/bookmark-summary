# 我的家庭网络设计思路，开启debian的旁路由之路（一）
- URL: https://evine.win/p/%E6%88%91%E7%9A%84%E5%AE%B6%E5%BA%AD%E7%BD%91%E7%BB%9C%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF%E5%BC%80%E5%90%AFdebian%E7%9A%84%E6%97%81%E8%B7%AF%E7%94%B1%E4%B9%8B%E8%B7%AF%E4%B8%80/
- Added At: 2025-03-04 12:01:55
- [Link To Text](2025-03-04-我的家庭网络设计思路，开启debian的旁路由之路（一）_raw.md)

## TL;DR
作者因OpenWRT旁路由问题改用Debian作为旁路由，设计了双子网网络架构，分别处理需要和不需要科学上网的设备。通过自建DNS服务，实现了国内IPv4/IPv6双栈支持，国外仅通过IPv4科学上网。文章是系列第一篇，后续将详细介绍Debian旁路由配置。

## Summary
1. **前言**：
   - 作者之前使用爱快作为主路由，OpenWRT作为旁路由，但由于OpenWRT上运行的服务过多，导致网络经常出现问题。
   - 决定抛弃OpenWRT，改用Debian作为旁路由。

2. **网络设计思路**：
   - 选择爱快作为主路由，Debian作为旁路由，因为爱快作为专业路由系统，查看数据更方便。
   - 旁路由的存在不能影响端口转发，必须由主路由直接转发到NAS及其他服务。

3. **IPv6处理**：
   - 作者需要保留国内网站的IPv6解析，屏蔽国外网站的IPv6解析。
   - 在旁路由上自建DNS服务，并关闭爱快的IPv6 DNS服务。

4. **网段划分**：
   - `10.0.0.0/24`作为科学上网的子网，旁路由的IP为`10.0.0.2/24`。
   - `10.0.1.0/24`作为无需科学上网的子网。

5. **爱快设置**：
   - `lan1`设置`10.0.0.1`为主IP，`10.0.1.1`为扩展IP。
   - DHCP服务器中分别设置两个子网的掩码、网关和DNS。
   - 为全部设备设置DHCP静态分配。
   - 关闭IPv6的DNS。

6. **交换机与AP**：
   - 如果主路由有足够的网口，交换机可以省略。
   - 如果主路由或旁路由有无线功能，AP也可以省略。

7. **旁路由配置**：
   - 旁路由是否为虚拟机不重要，作者的主路由是物理机，旁路由是虚拟机。
   - 许多设备通过虚拟机或Docker的MacVLAN接入网络中。

8. **总结**：
   - 通过分离为两个子网，将需要科学上网的设备和不需要科学上网的设备分开。
   - 在需要科学上网的子网下自建DNS服务器，达到国内支持IPv4/IPv6双栈，国外仅通过IPv4科学上网的目的。

9. **系列文章**：
   - 文章是系列的第一篇，后续将继续设置Debian为旁路由，详细介绍相关配置。

10. **相关链接**：
    - 提供了系列文章的其他部分链接，包括安装Debian、配置AdGuardHome、clash透明代理等。
